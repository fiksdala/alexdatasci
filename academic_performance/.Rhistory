head(health_predict)
ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()
head(health_predict)
## Health predictions
hvs <- unique(df$health_c)[order(unique(df$health_c))]
health_predict <- data.frame(absences_c=0,
health_c=hvs,
Dalc_c=0,
sex='F',
Walc_c=0)
health_predict
health_predict <- cbind(health_predict,predict(m3.4,
health_predict,
interval = 'confidence'))
colnames(health_predict)[6:8] <- slist('final_grade lwr upr')
health_predict$Health <- c(1,2,3,4,5)
head(health_predict)
# Then make graphs
ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()
ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()
labs(y='Final Grade)
ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade')
ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade')
# Then make graphs
ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()+
labs(y='Final Grade')
# Then make graphs
ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()+
labs(y='Final Grade',x='Weekend Alcohol Consumption')
ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade')
## Absence predictions
absence_pred <- data.frame(absences_c=df$absences_c,
health_c=0,
Dalc_c=0,
sex='F',
Walc_c=0)
absence_pred <- cbind(absence_pred,predict(m3.4,
absence_pred,
interval = 'confidence'))
colnames(absence_pred)[6:8] <- slist('final_grade lwr upr')
head(absence_pred)
a
head(absence_pred)
absence_pred$Absences <- df$absences
ggplot(absence_pred, aes(Absences,final_grade)) +
geom_count(data=df,aes(absences,G3)) +
geom_line()
ggplot(absence_pred, aes(Absences,final_grade)) +
geom_count(data=df,aes(absences,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade')
# Then make graphs
alc_graph <- ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()+
labs(y='Final Grade',x='Weekend Alcohol Consumption')
health_graph <- ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade')
abs_graph <- ggplot(absence_pred, aes(Absences,final_grade)) +
geom_count(data=df,aes(absences,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade')
# Then make graphs
alc_graph <- ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()+
labs(y='Final Grade',x='Weekend Alcohol Consumption (1=Very Low, 5=Very High)') +
geom_tile('Final Grades by Weekend Alcohol Consumption and Sex')
health_graph <- ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade') +
geom_tile('Final Grades by Health (1=Very Bad, 5=Very Good)')
# Then make graphs
alc_graph <- ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()+
labs(y='Final Grade',x='Weekend Alcohol Consumption (1=Very Low, 5=Very High)') +
ggtitle('Final Grades by Weekend Alcohol Consumption and Sex')
health_graph <- ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade') +
ggtitle('Final Grades by Health (1=Very Bad, 5=Very Good)')
abs_graph <- ggplot(absence_pred, aes(Absences,final_grade)) +
geom_count(data=df,aes(absences,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade') +
ggtitle('Final Grades by Absences')
# First get predictions
## Walc predictions
wvs <- unique(df$Walc_c)[order(unique(df$Walc_c))]
# First get predictions
## Walc predictions
wvs <- unique(df$Walc_c)[order(unique(df$Walc_c))]
drink_predict <- data.frame(absences_c=0,
health_c=0,
Dalc_c=0,
sex=slist('M M M M M F F F F F'),
Walc_c=c(wvs,wvs))
drink_predict <- cbind(drink_predict,predict(m3.4,
drink_predict,
interval = 'confidence'))
colnames(drink_predict)[6:8] <- slist('final_grade lwr upr')
drink_predict$Weekend_Alcohol <- c(1,2,3,4,5)
head(drink_predict)
## Health predictions
hvs <- unique(df$health_c)[order(unique(df$health_c))]
health_predict <- data.frame(absences_c=0,
health_c=hvs,
Dalc_c=0,
sex='F',
Walc_c=0)
health_predict <- cbind(health_predict,predict(m3.4,
health_predict,
interval = 'confidence'))
colnames(health_predict)[6:8] <- slist('final_grade lwr upr')
health_predict$Health <- c(1,2,3,4,5)
head(health_predict)
## Absence predictions
absence_pred <- data.frame(absences_c=df$absences_c,
health_c=0,
Dalc_c=0,
sex='F',
Walc_c=0)
absence_pred <- cbind(absence_pred,predict(m3.4,
absence_pred,
interval = 'confidence'))
colnames(absence_pred)[6:8] <- slist('final_grade lwr upr')
absence_pred$Absences <- df$absences
# Then make graphs
alc_graph <- ggplot(drink_predict,aes(Weekend_Alcohol,final_grade,linetype=sex)) +
geom_count(data=df,aes(Walc,G3,color=sex)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw()+
labs(y='Final Grade',x='Weekend Alcohol Consumption (1=Very Low, 5=Very High)') +
ggtitle('Final Grades by Weekend Alcohol Consumption and Sex')
health_graph <- ggplot(health_predict,aes(Health,final_grade)) +
geom_count(data=df,aes(health,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade') +
ggtitle('Final Grades by Health (1=Very Bad, 5=Very Good)')
abs_graph <- ggplot(absence_pred, aes(Absences,final_grade)) +
geom_count(data=df,aes(absences,G3)) +
geom_line() +
geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=.2) +
theme_bw() +
labs(y='Final Grade') +
ggtitle('Final Grades by Absences')
alc_graph
health_graph
abs_graph
alc_graph
health_graph
abs_graph
confint(m3.4)
0.001192718*4
0.42658*4
0.13977*4
range(df$G3)
t.test(df$G3~df$sex)
alc_graph
abs_graph
summary(m3.4)
0.09810*15
ggplot(df,aes(sex,G3)) +
boxplot()
ggdf <- melt(df[,slist('sex G3')],id.vars=sex)
ggdf <- df[,slist('sex G3')]
ggdf <- melt(ggdf,id.vars=sex)
ggdf <- melt(ggdf,id.vars='sex')
ggdf <- melt(df[,slist('sex G3')],id.vars='sex')
head(ggdf)
ggplot(ggdf,aes(sex,value)) +
boxplot()
ggplot(ggdf,aes(variable,value)) +
boxplot()
ggplot(ggdf,aes(as.factor(variable),value)) +
boxplot()
ggplot(ggdf,aes(as.factor(sex),value)) +
boxplot()
ggdf <- melt(df,id.vars='sex')
ggplot(ggdf,aes(sex,value)) +
geom_boxplot() +
facet_wrap(~variable, scales='free')
ggdf <- melt(df[,slist('sex G3')],id.vars='sex')
head(ggdf)
ggplot(ggdf,aes(variable,value)) +
boxplot()
ggplot(df,aes(sex,G3)) +
boxplot()
ggplot(df,aes(x=sex,G3)) +
boxplot()
ggplot(df,aes(x=sex,G3)) +
boxplot(x=sex)
ggplot(df,aes(x=sex,G3)) +
boxplot(data=df,x=sex)
ggdf <- melt(df[,slist('sex G3')])
head(ggdf)
ggdf$sex
ggplot(ggdf,aes(x=sex,G3)) +
boxplot(data=df,x=sex)
ggplot(ggdf,aes(x=sex,G3))
ggplot(ggdf,aes(x=sex,value))
ggplot(ggdf,aes(x=sex,value)) +
geom_boxplot()
ggplot(ggdf,aes(x=sex,value)) +
geom_boxplot() +
labs(x='Sex',y='Final Grade')
ggplot(ggdf,aes(x=sex,value)) +
geom_boxplot() +
labs(x='Sex',y='Final Grade') +
theme_bw()
ggdf <- melt(df[,slist('sex G3')],id.vars=sex)
ggdf <- melt(df[,slist('sex G3')],id.vars=sex)
ggdf <- melt(df[,slist('sex G3')],id.vars='sex')
ggplot(ggdf,aes(x=sex,value)) +
geom_boxplot() +
labs(x='Sex',y='Final Grade') +
theme_bw()
alc_graph
t.test(df$absences~df$sex)
pwcorr(df, slist('Walc absences'))
pwcorr(df, slist('Dalc absences'))
ggplot(df,aes(Dalc,absences)) +
geom_count()
ggplot(df,aes(Walc,absences)) +
geom_count()
ggplot(df,aes(Walc,absences)) +
geom_boxplot()
ggplot(df,aes(group=Walc,absences)) +
geom_boxplot()
ggplot(df,aes(group=Walc,y=absences)) +
geom_boxplot()
ggplot(df,aes(Walc,absences)) +
geom_count() +
geom_smooth
ggplot(df,aes(Walc,absences)) +
geom_count() +
geom_smooth()
ggplot(df,aes(Dalc,absences)) +
geom_count() +
geom_smooth()
car::Anova(absences~Walc,df)
qqnorm(log(df$absences))
qqnorm(log(df$absences+1))
gmodels::CrossTable(df$absences>0)
df$abs_ind <- ifelse(df$absences>0,1,0)
huh <- glm(abs_ind ~ Walc+Dalc,family=logit,df)
huh <- glm(abs_ind ~ Walc+Dalc,family='logit',df)
huh <- glm(abs_ind ~ Walc+Dalc,family=binomial(link='logit'),df)
summary(huh)
huh <- glm(abs_ind ~ Dalc,family=binomial(link='logit'),df)
summary(huh)
huh <- glm(abs_ind ~ Walc+sex,family=binomial(link='logit'),df)
summary(huh)
huh <- glm(abs_ind ~ Walc*sex,family=binomial(link='logit'),df)
summary(huh)
huh <- glm(abs_ind ~ Walc+health+sex,family=binomial(link='logit'),df)
summary(huh)
huh <- glm(abs_ind ~ health,family=binomial(link='logit'),df)
summary(huh)
adf <- df[df$absences>0,]
qqnorm(adf$absences)
qqnorm(log(adf$absences))
adf$logabs <- log(adf$absences)
lm(logabs~Walc,adf)
lm(logabs~Walc,adf) %>%
summary()
lm(logabs~Walc+Dalc,adf) %>%
summary()
lm(logabs~Walc,adf) %>%
summary()
lm(logabs~Dalc,adf) %>%
summary()
lm(logabs~Dalc+Walc,adf) %>%
summary()
lm(logabs~Dalc+Walc+Sex,adf) %>%
summary()
lm(logabs~Dalc+Walc+sex,df) %>%
summary()
a
lm(logabs~Dalc+Walc+sex,adf) %>%
summary()
lm(logabs~(Dalc+Walc)*sex,adf) %>%
summary()
lm(logabs~(Walc)*sex,adf) %>%
summary()
lm(logabs~(Dalc)*sex,adf) %>%
summary()
lm(logabs~Dalc>0,adf) %>%
summary()
lm(logabs~Dalc>1,adf) %>%
summary()
lm(logabs~Walc>1,adf) %>%
summary()
lm(logabs~health,adf) %>%
summary()
library(gmodels)
CrossTable(df$absences>0)
df$abs_ind <- ifelse(df$absences>0,1,0)
logm1 <- glm(abs_ind~Walc_c, family=binomial(link='logit'),df)
summary(lgm1)
summary(logm1)
summary(logm1.1)
logm1.1 <- glm(abs_ind~Walc_c, family=binomial(link='logit'),df)
summary(logm1.1)
logm1.2 <- glm(abs_ind~Walc_c+Dalc_c, family=binomial(link='logit'),df)
summary(logm1.2)
logm1 <- glm(abs_ind~Walc_c, family=binomial(link='logit'),df)
summary(logm1)
logm1.1 <- glm(abs_ind~Dalc_c, family=binomial(link='logit'),df)
summary(logm1.1)
logm1.2 <- glm(abs_ind~Walc_c+Dalc_c, family=binomial(link='logit'),df)
summary(logm1.2)
huh <- glm(abs_ind ~ Walc,family=binomial(link='logit'),df)
summary(huh)
logm1 <- glm(abs_ind~Walc_c, family=binomial(link='logit'),df)
summary(logm1)
logm1.1 <- glm(abs_ind~Dalc_c, family=binomial(link='logit'),df)
summary(logm1.1)
logm1.2 <- glm(abs_ind~Walc_c+Dalc_c, family=binomial(link='logit'),df)
summary(logm1.2)
logm1.1 <- glm(abs_ind~Dalc, family=binomial(link='logit'),df)
summary(logm1.1)
logm2 <- glm(abs_ind~Walc_c+sex, family=binomial(link='logit'),df)
summary(logm2)
logm2 <- glm(abs_ind~Walc_c+sex+health, family=binomial(link='logit'),df)
summary(logm2)
logm2$coefficients[1]
exp(logm2$coefficients[2])
exp(-1.12546)
exp(logm2$coefficients[2]) # Odds Ratio
summary(logm2)
exp(logm2$coefficients[2]) # Odds Ratio
logm2.1 <- glm(abs_ind~Walc_c*sex+health, family=binomial(link='logit'),df)
summary(logm2.1)
plot(logm2$resid)
# Logistic predictions
logpred <- data.frame(Walc_c=wvs,
sex='M',
health_c=0,
Walc=c(1:5))
predict(logm2,logpred)
logm2 <- glm(abs_ind~Walc_c+sex+health_c, family=binomial(link='logit'),df)
summary(logm2)
exp(logm2$coefficients[2]) # Odds Ratio
logm2.1 <- glm(abs_ind~Walc_c*sex+health_c, family=binomial(link='logit'),df)
summary(logm2.1)
# Logistic predictions
logpred <- data.frame(Walc_c=wvs,
sex='M',
health_c=0,
Walc=c(1:5))
predict(logm2,logpred)
predict(logm2,logpred,type='response')
predict(logm2,logpred,type='response',interval='confidence')
logpred$probability <- predict(logm2,logpred,type='response')
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line()
log_graph
summary(logm2)
exp(0.66302)
min(df$Walc)
log_graph <- ggplot(logpred, aes(Walc_c,probability)) +
geom_line()
log_graph
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line()
log_graph
df$abs_ind <- ifelse(df$absences>0,0,1)
logm1 <- glm(abs_ind~Walc_c, family=binomial(link='logit'),df)
summary(logm1)
logm1.1 <- glm(abs_ind~Dalc_c, family=binomial(link='logit'),df)
summary(logm1.1)
summary(logm1)
CrossTable(df$abs_ind)
CrossTable(df$absences>0)
df$abs_ind <- ifelse(df$absences>0,1,0)
CrossTable(df$absences>0)
CrossTable(df$abs_ind)
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Weekend Alcohol Consumption')
log_graph
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Weekend Alcohol Consumption') +
theme_bw()
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Weekend Alcohol Consumption') +
theme_bw()
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Weekend Alcohol Consumption') +
theme_classic()
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Weekend Alcohol Consumption') +
theme_classic()
log_graph
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Weekend Alcohol Consumption') +
theme_bw()
log_graph
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Alcohol Consumption') +
theme_bw()
log_graph
1.25*5
.25*5
summary(m3.4)
summary(logm2)
# Logistic predictions
logpred <- data.frame(Walc_c=1:100,
sex='M',
health_c=0,
Walc=c(1:100))
logpred$probability <- predict(logm2,logpred,type='response')
log_graph <- ggplot(logpred, aes(Walc,probability)) +
geom_line() +
labs(x='Weekend Alcohol Comsumption (1=Very Low, 5=Very High)',
y='Probability') +
ggtitle('Probability of Missing Any Classes by Alcohol Consumption') +
theme_bw()
log_graph
ggdf <- melt(df,id.vars='sex')
ggplot(ggdf,aes(sex,value)) +
geom_boxplot() +
facet_wrap(~variable, scales='free')
library(ggplot2)
library(reshape2)
ggdf <- melt(df,id.vars='sex')
ggplot(ggdf,aes(sex,value)) +
geom_boxplot() +
facet_wrap(~variable, scales='free')
slist
